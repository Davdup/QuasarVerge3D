{"code":"\"use strict\";(function(){var e={objCache:{},fadeAnnotations:!0,objClickCallbacks:[],pickedObject:\"\",objHoverCallbacks:[],hoveredObject:\"\",objMovementInfos:{},objDragOverCallbacks:[],objDragOverInfoByBlock:{},dragMoveOrigins:{},dragScaleOrigins:{},mediaElements:{},loadedFiles:{},loadedFile:\"\",promiseValue:\"\",animMixerCallbacks:[]};e.arHitPoint=new v3d.Vector3(0,0,0),e.states=[],e.percentage=0,e.animateParamUpdate=null,e.openedFile=\"\",e.xrSessionAcquired=!1,e.xrSessionCallbacks=[],e.screenCoords=new v3d.Vector2,e.gamepadIndex=0,e.AXIS_X=new v3d.Vector3(1,0,0),e.AXIS_Y=new v3d.Vector3(0,1,0),e.AXIS_Z=new v3d.Vector3(0,0,1),e.MIN_DRAG_SCALE=.001,e.SET_OBJ_ROT_EPS=1e-8,e.vec2Tmp=new v3d.Vector2,e.vec2Tmp2=new v3d.Vector2,e.vec3Tmp=new v3d.Vector3,e.vec3Tmp2=new v3d.Vector3,e.vec3Tmp3=new v3d.Vector3,e.vec3Tmp4=new v3d.Vector3,e.eulerTmp=new v3d.Euler,e.eulerTmp2=new v3d.Euler,e.quatTmp=new v3d.Quaternion,e.quatTmp2=new v3d.Quaternion,e.colorTmp=new v3d.Color,e.mat4Tmp=new v3d.Matrix4,e.planeTmp=new v3d.Plane,e.raycasterTmp=new v3d.Raycaster,e.intervals={},e.wooProductInfo={};var n=v3d.PL=v3d.PL||{};v3d.puzzles=n,n.procedures=n.procedures||{},n.execInitPuzzles=function(e){var n={percentage:0,output:{initOptions:{fadeAnnotations:!0,useBkgTransp:!1,preserveDrawBuf:!1,useCompAssets:!1,useFullscreen:!0,useCustomPreloader:!1,preloaderStartCb:function(){},preloaderProgressCb:function(){},preloaderEndCb:function(){}}}};n.container=void 0!==e&&\"container\"in e?e.container:\"\";return n.output},n.init=function(n,r){r=r||{},\"fadeAnnotations\"in r&&(e.fadeAnnotations=r.fadeAnnotations),this.procedures[\"play_anim\"]=g;var t,a,o,i,c,s,u,l={play_anim:g};function d(e){var n=e.getRoot(),r=\"Scene\"==n.type?n:null;return n.traverseAncestors((function(e){\"Scene\"==e.type&&(r=e)})),r}function f(e){return e&&\"v3d\"in e.userData&&\"animFrameRate\"in e.userData.v3d?e.userData.v3d.animFrameRate:24}var v=function(){function r(n){for(var r=e.animMixerCallbacks,t=[],a=0;a<r.length;a++)r[a][0]==n.action&&(r[a][0]=null,t.push(r[a][1]));for(a=0;a<t.length;a++)t[a]()}return function(){n.mixer&&!n.mixer.hasEventListener(\"finished\",r)&&n.mixer.addEventListener(\"finished\",r)}}();function p(r,t,a,o,i,c,s,u,l){if(t){\"string\"==typeof t&&(t=[t]);for(var p=0;p<t.length;p++){var m=t[p];m&&h(m)}v()}function h(t){var v=v3d.SceneUtils.getAnimationActionByName(n,t);if(v)switch(r){case\"PLAY\":if(!v.isRunning()){v.reset(),i&&\"AUTO\"!=i&&(v.loop=v3d[i]);var p=d(v),m=f(p);u||(v.repetitions=1/0);var h=Math.abs(parseFloat(c));l&&(h*=-1),v.timeScale=h,v.timeStart=null!==a?a/m:0,null!==o?v.getClip().duration=o/m:v.getClip().resetDuration(),v.time=h>=0?v.timeStart:v.getClip().duration,v.paused=!1,v.play();for(var b=e.animMixerCallbacks,g=!1,A=0;A<b.length;A++)b[A][0]==v&&b[A][1]==s&&(g=!0);g||e.animMixerCallbacks.push([v,s])}break;case\"STOP\":v.stop();for(b=e.animMixerCallbacks,A=0;A<b.length;A++)b[A][0]==v&&(b.splice(A,1),A--);break;case\"PAUSE\":v.paused=!0;break;case\"RESUME\":v.paused=!1;break;case\"SET_FRAME\":p=d(v),m=f(p);v.time=a?a/m:0,v.play(),v.paused=!0;break}}}function m(e,n){var r=[];if(Array.isArray(e)&&\"CONTAINER\"!=e[0]&&\"WINDOW\"!=e[0]&&\"DOCUMENT\"!=e[0]&&\"BODY\"!=e[0]&&\"QUERYSELECTOR\"!=e[0])for(var t=0;t<e.length;t++)r.push(h(e[t],n));else r.push(h(e,n));return r}function h(e,r){var t;if(Array.isArray(e)&&\"CONTAINER\"==e[0]){if(null!==n)t=n.container;else if(\"undefined\"!==typeof _initGlob){e=_initGlob.container;t=r?parent.document.getElementById(e):document.getElementById(e)}}else t=Array.isArray(e)&&\"WINDOW\"==e[0]?r?parent:window:Array.isArray(e)&&\"DOCUMENT\"==e[0]?r?parent.document:document:Array.isArray(e)&&\"BODY\"==e[0]?r?parent.document.body:document.body:Array.isArray(e)&&\"QUERYSELECTOR\"==e[0]?r?parent.document.querySelector(e):document.querySelector(e):r?parent.document.getElementById(e):document.getElementById(e);return t}function b(e,n,r,t){for(var a=m(n,r),o=0;o<a.length;o++){var i=a[o];i&&i.addEventListener(e,t,!1)}}function g(e,n,r){b(\"click\",n,!0,(function(n){0==r?(p(\"PLAY\",e,null,null,\"LoopOnce\",1,(function(){}),void 0,!1),r=1,console.log(r)):(p(\"PLAY\",e,null,null,\"LoopOnce\",1,(function(){}),void 0,!0),r=0,console.log(r))}))}function A(e){return\"AmbientLight\"!==e.type&&\"\"!==e.name&&!(e.isMesh&&e.isMaterialGeneratedMesh)}function O(r){var t,a=void 0!==e;return t=a?e.objCache[r]:null,t&&t.name===r||n.scene.traverse((function(n){!t&&A(n)&&n.name==r&&(t=n,a&&(e.objCache[r]=t))})),t}function C(){var e=[];return n.scene.traverse((function(n){A(n)&&e.push(n.name)})),e}function k(e){var r=[];return n.scene.traverse((function(n){if(A(n)){var t=n.groupNames;if(!t)return;for(var a=0;a<t.length;a++){var o=t[a];o==e&&r.push(n.name)}}})),r}function y(e){var n=[];return E(e,n),n}function E(e,n){if(\"string\"==typeof e)n.push(e);else if(Array.isArray(e)&&\"GROUP\"==e[0])for(var r=k(e[1]),t=0;t<r.length;t++)n.push(r[t]);else if(Array.isArray(e)&&\"ALL_OBJECTS\"==e[0])for(r=C(),t=0;t<r.length;t++)n.push(r[t]);else if(Array.isArray(e))for(t=0;t<e.length;t++)E(e[t],n)}function j(e){if(e.isMesh)return!0;for(var n=0;n<e.children.length;n++){var r=e.children[n];if(r.isMesh&&r.isMaterialGeneratedMesh)return!0}return!1}function S(e,n,r){if(A(e)){switch(n){case\"ALL\":r.indexOf(e.name)<0&&r.push(e.name);break;case\"ANNOTATION\":e.isAnnotation&&r.indexOf(e.name)<0&&r.push(e.name);break;case\"CAMERA\":e.isCamera&&r.indexOf(e.name)<0&&r.push(e.name);break;case\"LIGHT\":e.isLight&&r.indexOf(e.name)<0&&r.push(e.name);break;case\"MESH\":j(e)&&r.indexOf(e.name)<0&&r.push(e.name);break;default:console.error(\"getObjectsFrom: Unknown object type: \"+n);break}for(var t=0;t<e.children.length;t++){var a=e.children[t];S(a,n,r)}}}function T(e,n){var r=[];if(e=y(e),e){for(var t=0;t<e.length;t++){var a=e[t];if(a){var o=O(a);o&&S(o,n,r)}}return r}}function w(e,n,r,t){for(var a=m(r,t),o=0;o<a.length;o++){var i=a[o];i&&i.style&&(i.style[e]=n)}}function L(r,t,a){var o=n.renderer.domElement;if(o.addEventListener(t,s),\"mousedown\"==t){var i=a?\"touchstart\":\"touchend\";o.addEventListener(i,s)}var c=new v3d.Raycaster;function s(t){t.preventDefault();var a=0,i=0;if(t instanceof MouseEvent)a=t.offsetX/o.clientWidth,i=t.offsetY/o.clientHeight;else if(t instanceof TouchEvent){var s=o.getBoundingClientRect();a=(t.changedTouches[0].clientX-s.left)/s.width,i=(t.changedTouches[0].clientY-s.top)/s.height}e.screenCoords.x=2*a-1,e.screenCoords.y=2*-i+1,c.setFromCamera(e.screenCoords,n.camera);var u=[];n.scene.traverse((function(e){u.push(e)}));var l=c.intersectObjects(u);if(l.length>0){var d=l[0].object;r(d,t)}else r(null,t)}}function M(e,n){if(!n)return!1;for(var r=0;r<e.length;r++){if(n==e[r])return!0;var t=O(e[r]);if(t&&\"Group\"==t.type)for(var a=0;a<t.children.length;a++)if(n==t.children[a].name)return!0}return!1}function R(e){return e.isMesh&&e.isMaterialGeneratedMesh&&e.parent?e.parent.name:e.name}function P(n,r,t){n=y(n)||[];var a=n.filter((function(e){return e}));e.objHoverCallbacks.push({objNames:a,callbacks:[r,t]})}function D(e){if(!e)return{};var n=O(e);return n&&\"v3d\"in n.userData&&\"customProps\"in n.userData.v3d?n.userData.v3d.customProps:{}}function I(n,r,t){n=y(n)||[];var a=n.filter((function(e){return e}));e.objClickCallbacks.push({objNames:a,callbacks:[r,t]})}L((function(n){var r=e.hoveredObject,t=n?R(n):\"\";r!=t&&(e.objHoverCallbacks.forEach((function(n){M(n.objNames,r)&&(e.hoveredObject=r,n.callbacks[1]())})),e.objHoverCallbacks.forEach((function(n){M(n.objNames,t)&&(e.hoveredObject=t,n.callbacks[0]())})),e.hoveredObject=t)}),\"mousemove\"),L((function(n){e.pickedObject=n?R(n):\"\",e.objClickCallbacks.forEach((function(e){var r=n&&M(e.objNames,R(n));e.callbacks[r?0:1]()}))}),\"mousedown\"),t=0,c=0,g(\"Sphere01\",\"btnAnimCube\",t),g(\"Sphere02\",\"btnAnimSphere\",c),P(T([\"GROUP\",\"Collection 1\"],\"ALL\"),(function(){w(\"cursor\",\"pointer\",[\"BODY\"],!1)}),(function(){w(\"cursor\",\"default\",[\"BODY\"],!1)})),I(T([\"GROUP\",\"Collection 1\"],\"ALL\"),(function(){w(\"cursor\",\"default\",[\"BODY\"],!1),console.log(String(e.pickedObject)+\" has been clicked!\"),console.log(\"Custom props :\"+String(D(e.pickedObject))),u=e.pickedObject;var r=Object.defineProperties({},{cubeAnimState:{get:function(){return t},set:function(e){t=e}},obj:{get:function(){return a},set:function(e){a=e}},btnId:{get:function(){return o},set:function(e){o=e}},varName:{get:function(){return i},set:function(e){i=e}},sphereAnimState:{get:function(){return c},set:function(e){c=e}},hoveredObject:{get:function(){return s},set:function(e){s=e}},pickedObject:{get:function(){return u},set:function(e){u=e}}});Function(\"app\",\"v3d\",\"VARS\",\"PROC\",\"// Built-in variables: app, v3d, VARS, PROC\\nv3d.PL._vueEventBus.$emit('Object-clicked', { id: VARS['pickedObject']});\")(n,v3d,r,l)}),(function(){}))}})();","extractedComments":[]}